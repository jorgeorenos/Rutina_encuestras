---
title: "Análisis de sentimientos nrc y afinn"
author: "Jorge Orenos"
output: pdf_document
lang: "es"
documentclass: article
---

\pagebreak

```{r librerias, include=FALSE, message=FALSE}
# Limpiamos el área de trabajo
rm(list = ls())
# Cargamos librerias
library(tidyverse)
library(ggstatsplot)
source("C:/Users/salay/Desktop/Rutina_encuestras/funcion_disposicion.R")
```

```{r texto, include=FALSE}
estr <- scan("C:/Users/salay/Desktop/Rutina_encuestras/Códigos Dedoose/Dimensión Direccionamiento estratégico/1.1 Estrategia de direccionamiento.txt",
               what = character(), sep = "\n", fileEncoding = "UTF-8", allowEscapes = T)

innov <- scan("C:/Users/salay/Desktop/Rutina_encuestras/Códigos Dedoose/Dimensión Direccionamiento estratégico/1.2 Inovación y disposición al cambio.txt",
               what = character(), sep = "\n", fileEncoding = "UTF-8", allowEscapes = T)

clima <- scan("C:/Users/salay/Desktop/Rutina_encuestras/Códigos Dedoose/Dimensión Direccionamiento estratégico/1.3 Clima organizacional.txt",
               what = character(), sep = "\n", fileEncoding = "UTF-8", allowEscapes = T)

mecan <- scan("C:/Users/salay/Desktop/Rutina_encuestras/Códigos Dedoose/Dimensión Direccionamiento estratégico/1.4 Mecanísmo de comunicación.txt",
               what = character(), sep = "\n", fileEncoding = "UTF-8", allowEscapes = T)

gestion <- scan("C:/Users/salay/Desktop/Rutina_encuestras/Códigos Dedoose/Dimensión Direccionamiento estratégico/1.5 Enfoque de gestión por procesos.txt",
               what = character(), sep = "\n", fileEncoding = "UTF-8", allowEscapes = T)
```

# Análisis de sentimientos aplicado a direccionamiento estrategico

El análisis de disposición se aplicó a la dimensión *Estrategia de direccionamiento* para cada una de sus características. Estas son:

1.  Estrategia de direccionamiento
2.  Inovación y disposición al cambio
3.  Clima organizacional
4.  Mecanismos de comunicación y coordinación
5.  Enfoque de gestión por procesos

Los resultados son utilizados para el cáculo del Índice de Direccionamiento Estrategico (IDE). Además, de ello se presentan los índices para cada una de las características de la dimensión en un rango de 0 a 1. Una Característica con un valor menor 0.5 indica que hay una disposición negativa mientras que una característica mayor a 0.5 indica una disposición positiva.

## Análisis elaborado con el diccionario **afinn**

El diccionario fue creado por Finn Arup Nielsen de la Universidad Técnica de Dinamarca. Los resultados obtenidios son los siguientes:

| Característica                     | Valoración |
|------------------------------------|------------|
| Estrategia de direccionamiento     | 84         |
| Innovación y disposición al cambio | 36         |
| Clima Organizacional               | 82         |
| Mecanismos de comunicación         | 56         |
| Enfoque de gestión por procesos    | 40         |

: Restulados del análisis de disposición con el diccionario afinn

```{r analisis_afinn, include=FALSE}
# Análisis estrategia de direccionamiento
analisis_estr <- c()
for (i in seq_along(estr)) {
  valor <- disposicion(estr[i], diccionario = "afinn")
  analisis_estr[i] <- valor[[2]]
}

# Análisis innovación y disposición al cambio
analisis_innov <- c()
for (i in seq_along(innov)) {
  valor <- disposicion(innov[i], diccionario = "afinn")
  analisis_innov[i] <- valor[[2]]
}

# Análisis clima organizacional
analisis_clima <- c()
for (i in seq_along(clima)) {
  valor <- disposicion(clima[i], diccionario = "afinn")
  analisis_clima[i] <- valor[[2]]
}

# Análisis mecanismos de comunicación
analisis_mecan <- c()
for (i in seq_along(mecan)) {
  valor <- disposicion(mecan[i], diccionario = "afinn")
  analisis_mecan[i] <- valor[[2]]
}

# Análisis enfoque en gestión por procesos
analisis_gestion <- c()
for (i in seq_along(gestion)) {
  valor <- disposicion(gestion[i], diccionario = "afinn")
  analisis_gestion[i] <- valor[[2]]
}

rm(valor)
```

```{r graficas_afinn, include=FALSE, message=FALSE}
# Gráfica estrategia de direccionamiento
estr_p <- ggplot() +
  geom_col(aes(x = 1:length(analisis_estr),
           y = (2/pi)*atan(analisis_estr/10)), fill = "#2A5783") +
  geom_smooth(aes(x = 1:length(analisis_estr),
           y = (2/pi)*atan(analisis_estr/10),
           fill = "Tendencia"), se = FALSE, colour = "#9C0824") +
  guides(fill = guide_legend(title = "")) +
  geom_hline(yintercept = 0) +
  labs(title = "Estrategia de direccionamiento",
       y = "Ponderación", x = "") +
  theme_minimal() +
  theme(legend.position = "bottom",
        plot.title = element_text(hjust = 0.5))

innov_p <- ggplot() +
  geom_col(aes(x = 1:length(analisis_innov),
           y = (2/pi)*atan(analisis_innov/10)), fill = "#2A5783") +
  geom_smooth(aes(x = 1:length(analisis_innov),
           y = (2/pi)*atan(analisis_innov/10),
           fill = "Tendencia"), se = FALSE, colour = "#9C0824") +
  guides(fill = guide_legend(title = "")) +
  geom_hline(yintercept = 0) +
  labs(title = "Innovación y disposiciónal cambio",
       y = "Ponderación", x = "") +
  theme_minimal() +
  theme(legend.position = "bottom",
        plot.title = element_text(hjust = 0.5))

clima_p <- ggplot() +
  geom_col(aes(x = 1:length(analisis_clima),
           y = (2/pi)*atan(analisis_clima/10)), fill = "#2A5783") +
  geom_smooth(aes(x = 1:length(analisis_clima),
           y = (2/pi)*atan(analisis_clima/10),
           fill = "Tendencia"), se = FALSE, colour = "#9C0824") +
  guides(fill = guide_legend(title = "")) +
  geom_hline(yintercept = 0) +
  labs(title = "Clima Organizacional",
       y = "Ponderación", x = "") +
  theme_minimal() +
  theme(legend.position = "bottom",
        plot.title = element_text(hjust = 0.5))
```

Los resultados anteriores, aunque muestran la disposición de cada categoría, tiene el inconveniente de no hacer posible la comparación entre categorías esto debido a que el texto originador de cada valor tiene un tamaño distinto para cada categoría. Para solucionar este problema se sugiera hacer la sigiuente transformación:

$\frac{\text{V}_{p}}{\#p}-\frac{\text{V}_{n}}{\#n}$

en donde:

```{=tex}
\begin{itemize}
\item $\text{V}_p$ es la ponderación de cada palabra con connotación positiva,
\item $\#p$ es el número de palabras con connotación positiva,
\item $\text{V}_n$ es la ponderación de cada palabra con connotación negativa,
\item $\#n$ es el número de palabras con connotación negativa.
\end{itemize}
```

<<<<<<< HEAD
```{r Transfomraciones_Afinn, include=FALSE}
analisis_estr_df <- list()
=======
```{r Transformaciones, include=FALSE}
analisis_estr_df <- list() #porque vamos a guardar dataframes

>>>>>>> bb94e4113bdd8632b786699a114ee0d7662040b0
for (i in seq_along(estr)) {
  valor <- disposicion(estr[i], diccionario = "afinn")
  analisis_estr_df[[i]] <- valor[[1]]
}
<<<<<<< HEAD
analisis_estr_df <-  analisis_estr_df[analisis_estr!=0]
=======
analisis_estr_df <- analisis_estr_df[analisis_estr!=0]

>>>>>>> bb94e4113bdd8632b786699a114ee0d7662040b0
vp_1 <- 0
vn_1 <- 0
np_1 <- 0
nn_1 <- 0
<<<<<<< HEAD
for (i in seq_along(analisis_estr_df)){
=======
for (i in seq_along(analisis_estr_df)) {
>>>>>>> bb94e4113bdd8632b786699a114ee0d7662040b0
  vp_1 <- vp_1+sum(analisis_estr_df[[i]]$positivas)
  vn_1 <- vn_1+sum(analisis_estr_df[[i]]$negativas)
  np_1 <- np_1+sum(analisis_estr_df[[i]]$negativas==FALSE)
  nn_1 <- nn_1+sum(analisis_estr_df[[i]]$positivas==FALSE)
}

<<<<<<< HEAD
Promedio_absoluto_ED <- vp_1/np_1-vn_1/nn_1

analisis_innov_df <- list()
for (i in seq_along(innov)) {
  valor <- disposicion(innov[i], diccionario = "afinn")
  analisis_innov_df[[i]] <- valor[[1]]
}
analisis_innov_df <-  analisis_innov_df[analisis_innov!=0]
vp_2 <- 0
vn_2 <- 0
np_2 <- 0
nn_2 <- 0
for (i in seq_along(analisis_innov_df)){
  vp_2 <- vp_2+sum(analisis_innov_df[[i]]$positivas)
  vn_2 <- vn_2+sum(analisis_innov_df[[i]]$negativas)
  np_2 <- np_2+sum(analisis_innov_df[[i]]$negativas==FALSE)
  nn_2 <- nn_2+sum(analisis_innov_df[[i]]$positivas==FALSE)
}

Promedio_absoluto_BI <- vp_2/np_2-vn_2/nn_2

analisis_clima_df <- list()
for (i in seq_along(clima)) {
  valor <- disposicion(clima[i], diccionario = "afinn")
  analisis_clima_df[[i]] <- valor[[1]]
}
analisis_clima_df <-  analisis_clima_df[analisis_clima!=0]
vp_3 <- 0
vn_3 <- 0
np_3 <- 0
nn_3 <- 0
for (i in seq_along(analisis_clima_df)){
  vp_3 <- vp_3+sum(analisis_clima_df[[i]]$positivas)
  vn_3 <- vn_3+sum(analisis_clima_df[[i]]$negativas)
  np_3 <- np_3+sum(analisis_clima_df[[i]]$negativas==FALSE)
  nn_3 <- nn_3+sum(analisis_clima_df[[i]]$positivas==FALSE)
}

Promedio_absoluto_CO <- vp_3/np_3-vn_3/nn_3


analisis_mecan_df <- list()
for (i in seq_along(mecan)) {
  valor <- disposicion(mecan[i], diccionario = "afinn")
  analisis_mecan_df[[i]] <- valor[[1]]
}
analisis_mecan_df <-  analisis_mecan_df[analisis_mecan!=0]
vp_4 <- 0
vn_4 <- 0
np_4 <- 0
nn_4 <- 0
for (i in seq_along(analisis_mecan_df)){
  vp_4 <- vp_4+sum(analisis_mecan_df[[i]]$positivas)
  vn_4 <- vn_4+sum(analisis_mecan_df[[i]]$negativas)
  np_4 <- np_4+sum(analisis_mecan_df[[i]]$negativas==FALSE)
  nn_4 <- nn_4+sum(analisis_mecan_df[[i]]$positivas==FALSE)
}

Promedio_absoluto_MC <- vp_4/np_4-vn_4/nn_4


analisis_gestion_df <- list()
for (i in seq_along(gestion)) {
  valor <- disposicion(gestion[i], diccionario = "afinn")
  analisis_gestion_df[[i]] <- valor[[1]]
}
analisis_gestion_df <-  analisis_gestion_df[analisis_gestion!=0]
vp_5 <- 0
vn_5 <- 0
np_5 <- 0
nn_5 <- 0
for (i in seq_along(analisis_gestion_df)){
  vp_5 <- vp_5+sum(analisis_gestion_df[[i]]$positivas)
  vn_5 <- vn_5+sum(analisis_gestion_df[[i]]$negativas)
  np_5 <- np_5+sum(analisis_gestion_df[[i]]$negativas==FALSE)
  nn_5 <- nn_5+sum(analisis_gestion_df[[i]]$positivas==FALSE)
}

Promedio_absoluto_GPR <- vp_5/np_5-vn_5/nn_5


promedios_absolutos <- c(Promedio_absoluto_ED, Promedio_absoluto_BI, Promedio_absoluto_CO, Promedio_absoluto_MC, Promedio_absoluto_GPR)
c <- 1
y1 <- (2*(c)/pi)*(atan(promedios_absolutos/(10*c)))

y2 <- (1/(2*c))*(y1+c)
=======
>>>>>>> bb94e4113bdd8632b786699a114ee0d7662040b0

```



<<<<<<< HEAD


=======
>>>>>>> bb94e4113bdd8632b786699a114ee0d7662040b0
